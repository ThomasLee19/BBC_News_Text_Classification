(bbc_news) PS D:\NTU\EE6405\Group Project\code> python main.py

============================================================
BBCæ–°é—»æ–‡æœ¬åˆ†ç±» - åºåˆ—æ¨¡å‹å®éªŒ
æˆå‘˜A - RNN/LSTM/GRUæ¨¡å‹è®­ç»ƒä¸è¯„ä¼°
============================================================
å¼€å§‹æ—¶é—´: 2025-10-30 02:19:01
============================================================

[é¢„æ£€æŸ¥] æ£€æŸ¥è¿è¡Œç¯å¢ƒ...
âœ“ ä¾èµ–åŒ…æ£€æŸ¥é€šè¿‡
âœ“ æ¨¡å‹æ–‡ä»¶æ£€æŸ¥é€šè¿‡
âœ“ æ•°æ®æ–‡ä»¶æ£€æŸ¥é€šè¿‡

[æ¨¡å¼] è¿è¡Œå®Œæ•´æµç¨‹ï¼ˆè®­ç»ƒ+è¯„ä¼°ï¼‰

============================================================
æ­¥éª¤ 1/2: å¼€å§‹è®­ç»ƒæ¨¡å‹
============================================================
============================================================
BBCæ–°é—»æ–‡æœ¬åˆ†ç±» - åºåˆ—æ¨¡å‹è®­ç»ƒ
============================================================
è®¾å¤‡: cuda
Batch Size: 64
Learning Rate: 0.001
Max Epochs: 50
Early Stop Patience: 5
============================================================

[1/5] åŠ è½½æ•°æ®...
æ­£åœ¨æ„å»ºè¯æ±‡è¡¨...
è¯æ±‡è¡¨å¤§å°: 10000
è¦†ç›–è¯æ•°: 360279/382136
è®­ç»ƒé›†å¤§å°: 1780
éªŒè¯é›†å¤§å°: 222
æµ‹è¯•é›†å¤§å°: 223
è¯æ±‡è¡¨å¤§å°: 10000

[2/5] è®­ç»ƒRNNæ¨¡å‹...
RNNå‚æ•°é‡: 1,092,933

============================================================
å¼€å§‹è®­ç»ƒ RNN æ¨¡å‹
============================================================

Epoch 1/50
Train Loss: 1.7111 | Train Acc: 20.53%
Val Loss: 1.6246 | Val Acc: 25.47%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 25.47%)

Epoch 2/50
Train Loss: 1.7473 | Train Acc: 21.43%
Val Loss: 1.6427 | Val Acc: 18.57%

Epoch 3/50
Train Loss: 1.8415 | Train Acc: 22.45%
Val Loss: 1.6389 | Val Acc: 20.73%

Epoch 4/50
Train Loss: 1.8055 | Train Acc: 19.76%
Val Loss: 1.6501 | Val Acc: 19.01%

Epoch 5/50
Train Loss: 1.7541 | Train Acc: 21.50%
Val Loss: 1.6009 | Val Acc: 23.75%

Epoch 6/50
Train Loss: 1.7464 | Train Acc: 23.56%
Val Loss: 1.6587 | Val Acc: 22.08%

Early stopping triggered after 6 epochs

============================================================
RNN è®­ç»ƒå®Œæˆï¼
æœ€ä½³éªŒè¯å‡†ç¡®ç‡: 25.47%
è®­ç»ƒæ—¶é—´: 2.91ç§’
============================================================

[3/5] è®­ç»ƒLSTMæ¨¡å‹...
LSTMå‚æ•°é‡: 3,312,709

============================================================
å¼€å§‹è®­ç»ƒ LSTM æ¨¡å‹
============================================================

Epoch 1/50
Train Loss: 1.6013 | Train Acc: 22.72%
Val Loss: 1.5655 | Val Acc: 43.98%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 43.98%)

Epoch 2/50
Train Loss: 1.4073 | Train Acc: 40.80%
Val Loss: 1.2137 | Val Acc: 37.89%

Epoch 3/50
Train Loss: 1.0388 | Train Acc: 50.30%
Val Loss: 0.9216 | Val Acc: 69.90%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 69.90%)

Epoch 4/50
Train Loss: 0.6075 | Train Acc: 77.34%
Val Loss: 0.5784 | Val Acc: 80.89%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 80.89%)

Epoch 5/50
Train Loss: 0.3124 | Train Acc: 88.08%
Val Loss: 0.3403 | Val Acc: 87.68%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 87.68%)

Epoch 6/50
Train Loss: 0.1383 | Train Acc: 96.18%
Val Loss: 0.4500 | Val Acc: 85.29%

Epoch 7/50
Train Loss: 0.0956 | Train Acc: 97.82%
Val Loss: 0.4589 | Val Acc: 88.80%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 88.80%)

Epoch 8/50
Train Loss: 0.0490 | Train Acc: 98.55%
Val Loss: 0.2803 | Val Acc: 92.03%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 92.03%)

Epoch 9/50
Train Loss: 0.0429 | Train Acc: 98.65%
Val Loss: 0.3746 | Val Acc: 91.59%

Epoch 10/50
Train Loss: 0.0127 | Train Acc: 99.72%
Val Loss: 0.6037 | Val Acc: 85.23%

Epoch 11/50
Train Loss: 0.0115 | Train Acc: 99.78%
Val Loss: 0.3845 | Val Acc: 89.64%

Epoch 12/50
Train Loss: 0.0014 | Train Acc: 100.00%
Val Loss: 0.3749 | Val Acc: 89.97%

Epoch 13/50
Train Loss: 0.0008 | Train Acc: 100.00%
Val Loss: 0.2870 | Val Acc: 92.42%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 92.42%)

Epoch 14/50
Train Loss: 0.0005 | Train Acc: 100.00%
Val Loss: 0.2932 | Val Acc: 93.65%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 93.65%)

Epoch 15/50
Train Loss: 0.0005 | Train Acc: 100.00%
Val Loss: 0.3040 | Val Acc: 94.04%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 94.04%)

Epoch 16/50
Train Loss: 0.0053 | Train Acc: 99.94%
Val Loss: 0.4083 | Val Acc: 92.86%

Epoch 17/50
Train Loss: 0.0044 | Train Acc: 99.75%
Val Loss: 0.5377 | Val Acc: 87.19%

Epoch 18/50
Train Loss: 0.0053 | Train Acc: 99.83%
Val Loss: 0.4711 | Val Acc: 89.69%

Epoch 19/50
Train Loss: 0.0049 | Train Acc: 99.89%
Val Loss: 0.5570 | Val Acc: 89.19%

Epoch 20/50
Train Loss: 0.0041 | Train Acc: 99.89%
Val Loss: 0.4758 | Val Acc: 88.75%

Early stopping triggered after 20 epochs

============================================================
LSTM è®­ç»ƒå®Œæˆï¼
æœ€ä½³éªŒè¯å‡†ç¡®ç‡: 94.04%
è®­ç»ƒæ—¶é—´: 24.03ç§’
============================================================

[4/5] è®­ç»ƒGRUæ¨¡å‹...
GRUå‚æ•°é‡: 2,735,173

============================================================
å¼€å§‹è®­ç»ƒ GRU æ¨¡å‹
============================================================

Epoch 1/50
Train Loss: 1.5811 | Train Acc: 27.36%
Val Loss: 1.4565 | Val Acc: 47.60%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 47.60%)

Epoch 2/50
Train Loss: 1.5111 | Train Acc: 61.76%
Val Loss: 0.5192 | Val Acc: 86.22%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 86.22%)

Epoch 3/50
Train Loss: 0.2270 | Train Acc: 93.18%
Val Loss: 0.1197 | Val Acc: 96.48%
âœ“ ä¿å­˜æœ€ä½³æ¨¡å‹ (Val Acc: 96.48%)

Epoch 4/50
Train Loss: 0.0596 | Train Acc: 97.88%
Val Loss: 0.1293 | Val Acc: 95.65%

Epoch 5/50
Train Loss: 0.0334 | Train Acc: 99.16%
Val Loss: 0.1227 | Val Acc: 96.04%

Epoch 6/50
Train Loss: 0.0280 | Train Acc: 99.06%
Val Loss: 0.2512 | Val Acc: 93.26%

Epoch 7/50
Train Loss: 0.0122 | Train Acc: 99.67%
Val Loss: 0.1450 | Val Acc: 94.04%

Epoch 8/50
Train Loss: 0.0155 | Train Acc: 99.72%
Val Loss: 0.1716 | Val Acc: 95.70%

Early stopping triggered after 8 epochs

============================================================
GRU è®­ç»ƒå®Œæˆï¼
æœ€ä½³éªŒè¯å‡†ç¡®ç‡: 96.48%
è®­ç»ƒæ—¶é—´: 9.51ç§’
============================================================

[5/5] è®­ç»ƒç»“æœæ±‡æ€»
============================================================
æ¨¡å‹         éªŒè¯å‡†ç¡®ç‡           è®­ç»ƒæ—¶é—´(s)         å‚æ•°é‡
------------------------------------------------------------
RNN         25.47%            2.91          1,092,933
LSTM        94.04%           24.03          3,312,709
GRU         96.48%            9.51          2,735,173
============================================================

âœ“ æ‰€æœ‰æ¨¡å‹è®­ç»ƒå®Œæˆï¼
âœ“ æ¨¡å‹ä¿å­˜è·¯å¾„: ./checkpoints
âœ“ æ—¥å¿—ä¿å­˜è·¯å¾„: ./logs

âœ“ è®­ç»ƒå®Œæˆï¼

============================================================
æ­¥éª¤ 2/2: å¼€å§‹è¯„ä¼°æ¨¡å‹å¹¶ç”Ÿæˆå¯è§†åŒ–
============================================================
============================================================
BBCæ–°é—»æ–‡æœ¬åˆ†ç±» - æ¨¡å‹è¯„ä¼°ä¸å¯è§†åŒ–
============================================================
è®¾å¤‡: cuda
============================================================

[1/6] åŠ è½½æ•°æ®...
æ­£åœ¨æ„å»ºè¯æ±‡è¡¨...
è¯æ±‡è¡¨å¤§å°: 10000
è¦†ç›–è¯æ•°: 360279/382136
æµ‹è¯•é›†å¤§å°: 223
è¯æ±‡è¡¨å¤§å°: 10000

[2/6] åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹...
åŠ è½½ RNN æ¨¡å‹...
âœ“ RNN æ¨¡å‹åŠ è½½å®Œæˆ (Epoch 0, Val Acc: 25.47%)
åŠ è½½ LSTM æ¨¡å‹...
âœ“ LSTM æ¨¡å‹åŠ è½½å®Œæˆ (Epoch 14, Val Acc: 94.04%)
åŠ è½½ GRU æ¨¡å‹...
âœ“ GRU æ¨¡å‹åŠ è½½å®Œæˆ (Epoch 2, Val Acc: 96.48%)

[3/6] åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°æ¨¡å‹...

è¯„ä¼° RNN æ¨¡å‹...
  Accuracy:  23.32%
  Precision: 18.63%
  Recall:    23.32%
  F1-Score:  13.06%

è¯„ä¼° LSTM æ¨¡å‹...
  Accuracy:  91.93%
  Precision: 93.45%
  Recall:    91.93%
  F1-Score:  92.19%

è¯„ä¼° GRU æ¨¡å‹...
  Accuracy:  94.17%
  Precision: 94.44%
  Recall:    94.17%
  F1-Score:  94.25%

[4/6] ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨...
âœ“ è®­ç»ƒæ›²çº¿å·²ä¿å­˜: ./figures\1_training_curves.png
âœ“ RNN æ··æ·†çŸ©é˜µå·²ä¿å­˜: ./figures\2_confusion_matrix_RNN.png
âœ“ LSTM æ··æ·†çŸ©é˜µå·²ä¿å­˜: ./figures\2_confusion_matrix_LSTM.png
âœ“ GRU æ··æ·†çŸ©é˜µå·²ä¿å­˜: ./figures\2_confusion_matrix_GRU.png
âœ“ æ¨¡å‹å¯¹æ¯”å›¾å·²ä¿å­˜: ./figures\3_model_comparison.png
âœ“ ç»¼åˆå¯¹æ¯”å›¾å·²ä¿å­˜: ./figures\4_comprehensive_comparison.png
âœ“ å„ç±»åˆ«æ€§èƒ½å¯¹æ¯”å›¾å·²ä¿å­˜: ./figures\5_per_class_performance.png

[5/6] ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š...
âœ“ åˆ†ç±»æŠ¥å‘Šå·²ä¿å­˜: ./figures\classification_report.txt

[6/6] è¯„ä¼°ç»“æœæ±‡æ€»
================================================================================
æ¨¡å‹         Accuracy     Precision    Recall       F1-Score
--------------------------------------------------------------------------------
RNN         23.32%      18.63%       23.32%      13.06%
LSTM        91.93%      93.45%       91.93%      92.19%
GRU         94.17%      94.44%       94.17%      94.25%
================================================================================

âœ“ æ‰€æœ‰è¯„ä¼°å®Œæˆï¼
âœ“ å›¾è¡¨ä¿å­˜è·¯å¾„: ./figures

ç”Ÿæˆçš„å›¾è¡¨æ–‡ä»¶:
  1. 1_training_curves.png - è®­ç»ƒ/éªŒè¯æ›²çº¿
  2. 2_confusion_matrix_[MODEL].png - æ··æ·†çŸ©é˜µï¼ˆ3ä¸ªï¼‰
  3. 3_model_comparison.png - æ¨¡å‹æ€§èƒ½å¯¹æ¯”
  4. 4_comprehensive_comparison.png - ç»¼åˆå¯¹æ¯”ï¼ˆå«æ—¶é—´å’Œå‚æ•°ï¼‰
  5. 5_per_class_performance.png - å„ç±»åˆ«æ€§èƒ½å¯¹æ¯”
  6. classification_report.txt - è¯¦ç»†åˆ†ç±»æŠ¥å‘Š
  7. evaluation_results.json - è¯„ä¼°ç»“æœJSON

âœ“ è¯„ä¼°å®Œæˆï¼

============================================================
âœ“ æ‰€æœ‰æµç¨‹æ‰§è¡ŒæˆåŠŸï¼

============================================================
å®éªŒç»“æœæ‘˜è¦
============================================================

ã€æ¨¡å‹æ€§èƒ½å¯¹æ¯”ã€‘
------------------------------------------------------------
æ¨¡å‹       éªŒè¯å‡†ç¡®ç‡        æµ‹è¯•å‡†ç¡®ç‡        F1-Score     è®­ç»ƒæ—¶é—´
------------------------------------------------------------
RNN       25.47%       23.32%       13.06%         2.9s
LSTM      94.04%       91.93%       92.19%        24.0s
GRU       96.48%       94.17%       94.25%         9.5s
------------------------------------------------------------

ğŸ† æœ€ä½³æ¨¡å‹: GRU (æµ‹è¯•å‡†ç¡®ç‡: 94.17%)

ã€ç”Ÿæˆçš„æ–‡ä»¶ã€‘
------------------------------------------------------------
æ¨¡å‹æƒé‡:
  âœ“ checkpoints/RNN_best.pth
  âœ“ checkpoints/LSTM_best.pth
  âœ“ checkpoints/GRU_best.pth

è®­ç»ƒæ—¥å¿—:
  âœ“ logs/RNN_history.json
  âœ“ logs/LSTM_history.json
  âœ“ logs/GRU_history.json
  âœ“ logs/final_results.json

å¯è§†åŒ–å›¾è¡¨:
  âœ“ figures/1_training_curves.png
  âœ“ figures/2_confusion_matrix_RNN.png
  âœ“ figures/2_confusion_matrix_LSTM.png
  âœ“ figures/2_confusion_matrix_GRU.png
  âœ“ figures/3_model_comparison.png
  âœ“ figures/4_comprehensive_comparison.png
  âœ“ figures/5_per_class_performance.png
  âœ“ figures/classification_report.txt
  âœ“ figures/evaluation_results.json

============================================================
æ€»è€—æ—¶: 43.14 ç§’ (0.72 åˆ†é’Ÿ)
ç»“æŸæ—¶é—´: 2025-10-30 02:19:44
============================================================